function LunchTime(a){this.version="1.1",this.settings={srcFile:"https://js-whatsforlunch.firebaseio.com/",items:["Item 1","Item 2","Item 3","Item 4"],mainContainer:"container",listContainer:{idName:"lunchList",classNormal:"item",classSelected:"selected"},timer:{interval:150,increment:250,threshold:[3e3,3e3,3e3]},allowAudio:!1,srcAudio:{selection:"audio/beep.mp3",selected:"audio/tadaa.mp3"},randomise:!1,allowExlcusions:!1};var b=["start","disabled","loading"],c=0,d=0,e=this.settings.timer.interval,f=this.settings.timer.threshold[d],g={},h=this;fbRef=new Firebase(this.settings.srcFile),this.init=function(){if(this.setMode(b[2]),fbRef.on("value",function(a){var c=[],d=document.getElementById(h.settings.listContainer.idName),e=document.getElementsByTagName("body")[0],f=e.className.indexOf(b[0])>=0?!0:!1,g=e.className.indexOf(b[2])>=0?!0:!1;if(fbItems=a.val(),f||g){for(var i in fbItems)c.push(fbItems[i]);for(h.settings.items=c,h.setMode(b[0]);d.firstChild;)d.removeChild(d.firstChild);d.appendChild(h.buildList(h.settings.randomise?h.getRandomiseList(h.settings.items):h.settings.items))}}),"undefined"!=typeof a)for(var c in this.settings)this.settings.hasOwnProperty(c)&&"undefined"!=typeof a[c]&&(this.settings[c]=a[c]);if(this.settings.allowAudio)for(var c in this.settings.srcAudio)g[c]=this.audioTrack(c,this.settings.srcAudio[c],1,!1);document.getElementById("button").addEventListener("click",this.buttonStart,!1)},this.intervalRandomise=function(){this.intCounter=setTimeout(function(){var a,b=h.getRandomiseIndex(),g=h.settings.listContainer.classNormal,i=h.settings.listContainer.classSelected,j=document.getElementById(h.settings.listContainer.idName),k=j.getElementsByTagName("li");console.log(b);for(var l=0;l<k.length;l++)a=b===l?g.concat(" ",i):g,k[l].className=a;c+=e,d<h.settings.timer.threshold.length?(h.playAudio("selection"),h.intervalRandomise()):(h.intCounter=null,h.displayOutcome()),c>f&&(d++,f+=h.settings.timer.threshold[d],e+=h.settings.timer.increment)},Math.round(e))},this.getRandomiseIndex=function(){return Math.floor(Math.random()*(h.settings.items.length-1+1))},this.getRandomiseList=function(a){for(var b=a.length-1;b>0;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}return a},this.buildList=function(a){for(var b=document.createElement("ul"),c=0;c<a.length;c++){var d=document.createElement("li"),e=document.createElement("span");e.appendChild(document.createTextNode(a[c])),d.appendChild(e),d.className=h.settings.listContainer.classNormal,b.appendChild(d)}return b},this.setMode=function(a){var b=document.getElementsByTagName("body")[0];b.className=a},this.buttonStart=function(){this.disabled=!0,h.setMode(b[1]),h.intervalRandomise()},this.displayOutcome=function(){this.playAudio("selected"),this.reset()},this.reset=function(){var a=document.getElementById("button");a.disabled=!1,h.setMode(b[0]),c=0,d=0,e=this.settings.timer.interval,f=this.settings.timer.threshold[d]},this.playAudio=function(a){g.hasOwnProperty(a)&&this.settings.allowAudio&&(g[a].pause(),g[a].currentTime=0,g[a].play())},this.audioTrack=function(a,b,c,d){var e=document.createElement("audio");return e.name=a,e.src=b,e.volume=c,e.loop=d,e.preload="auto",e},this.init()}